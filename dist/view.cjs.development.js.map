{"version":3,"file":"view.cjs.development.js","sources":["../src/html.ts","../src/render.ts","../src/reactivity.ts","../src/scheduler.ts","../src/component.ts","../src/directive.ts","../src/directives/text.ts","../src/directives/input.ts"],"sourcesContent":["const isLetter = (c: string): boolean => {\n  return c.toLowerCase() != c.toUpperCase();\n};\n\nexport enum DirectiveType {\n  TEXT,\n  ATTRIBUTE,\n  ATTRIBUTE_VALUE,\n}\nexport interface DirectiveData {\n  d: Function;\n  t?: DirectiveType;\n  a?: string;\n  n?: Node;\n}\nconst insertAttributeMarker = (\n  marker: string,\n  si: number,\n  appendedStatic: string\n): string => {\n  while (si++) {\n    const char = appendedStatic.charAt(si);\n    if (!char) {\n      break;\n    }\n    if (char === ' ') {\n      return (\n        appendedStatic.slice(0, si) + ' ' + marker + appendedStatic.slice(si)\n      );\n    }\n  }\n  return appendedStatic;\n};\nexport const getTextMarker = (id: number): string => {\n  return `tm-${id}`;\n};\nexport const getAttributeMarker = (id: number): string => {\n  return `data-am-${id}`;\n};\nexport interface HTMLResult {\n  template: HTMLTemplateElement;\n  directives: DirectiveData[];\n}\nlet resultCache: WeakMap<TemplateStringsArray, HTMLResult> = new WeakMap();\nexport const html = (\n  staticParts: TemplateStringsArray,\n  ...dynamicParts: any[]\n): HTMLResult => {\n  let result: HTMLResult = resultCache.get(staticParts);\n  if (!result) {\n    let appendedStatic: string = '';\n    const directives: DirectiveData[] = [];\n    for (let i = 0; i < dynamicParts.length; i++) {\n      const dynamicPart = dynamicParts[i];\n      const staticPart = staticParts[i];\n      appendedStatic += staticPart;\n      if (typeof dynamicPart !== 'function') {\n        appendedStatic += dynamicPart;\n        continue;\n      }\n      let id =\n        directives.push({\n          d: dynamicPart,\n        }) - 1;\n      let si = appendedStatic.length + 1;\n      let attributeValueMode = false;\n      let attributeMode = false;\n      let attributeNameFound = false;\n      let attributeName = '';\n      while (si--) {\n        const char = appendedStatic.charAt(si);\n        const nextChar = appendedStatic.charAt(si - 1);\n        const nextNextChar = appendedStatic.charAt(si - 2);\n        if (char === '>' || si === 0) {\n          let marker = getTextMarker(id);\n          appendedStatic += `<${marker}>&zwnj;</${marker}>`;\n          directives[id].t = DirectiveType.TEXT;\n          break;\n        }\n        if (\n          char === '\"' &&\n          nextChar === '=' &&\n          isLetter(nextNextChar) &&\n          !attributeMode\n        ) {\n          attributeValueMode = true;\n          continue;\n        }\n        if (char === '\"' && nextNextChar !== '=' && !attributeValueMode) {\n          attributeValueMode = false;\n          attributeMode = true;\n          continue;\n        }\n        if (\n          attributeValueMode &&\n          char !== '\"' &&\n          char !== '=' &&\n          !attributeNameFound\n        ) {\n          if (char !== ' ') {\n            attributeName = char + attributeName;\n          } else {\n            attributeNameFound = true;\n          }\n        }\n        if (char === '<' && attributeValueMode) {\n          appendedStatic = insertAttributeMarker(\n            getAttributeMarker(id),\n            si,\n            appendedStatic\n          );\n          directives[id].t = DirectiveType.ATTRIBUTE_VALUE;\n          directives[id].a = attributeName;\n          if (appendedStatic[appendedStatic.length - 1] === ' ') {\n            appendedStatic = appendedStatic.slice(0, appendedStatic.length - 1);\n          }\n          break;\n        }\n        if (char === '<' && !attributeValueMode) {\n          appendedStatic = insertAttributeMarker(\n            getAttributeMarker(id),\n            si,\n            appendedStatic\n          );\n          directives[id].t = DirectiveType.ATTRIBUTE;\n          break;\n        }\n      }\n    }\n    appendedStatic += staticParts[staticParts.length - 1];\n    const template = document.createElement('template');\n    template.innerHTML = appendedStatic;\n    result = {\n      template,\n      directives,\n    };\n  } else {\n    let directiveIndex: number = 0;\n    dynamicParts.forEach((value: any) => {\n      if (typeof value === 'function') {\n        result.directives[directiveIndex].d = value;\n        directiveIndex++;\n      }\n    });\n  }\n  resultCache.set(staticParts, result);\n  return result;\n};\n","import {\n  HTMLResult,\n  DirectiveType,\n  getTextMarker,\n  getAttributeMarker,\n} from './html';\n\nconst childNodesMap: WeakMap<HTMLElement, NodeList> = new WeakMap();\nexport const render = (\n  container: HTMLElement,\n  htmlResult: HTMLResult\n): void => {\n  if (!childNodesMap.has(container)) {\n    const fragment: DocumentFragment = htmlResult.template.content.cloneNode(\n      true\n    ) as DocumentFragment;\n    htmlResult.directives.forEach((directiveData, id) => {\n      switch (directiveData.t) {\n        case DirectiveType.TEXT:\n          const placeholder = fragment.querySelector(getTextMarker(id));\n          const textNode = placeholder.firstChild;\n          directiveData.n = textNode;\n          placeholder.parentElement.replaceChild(textNode, placeholder);\n          break;\n        case DirectiveType.ATTRIBUTE:\n        case DirectiveType.ATTRIBUTE_VALUE:\n          const marker = getAttributeMarker(id);\n          const node = fragment.querySelector(`[${marker}]`);\n          node.removeAttribute(marker);\n          directiveData.n = node;\n      }\n    });\n    childNodesMap.set(container, fragment.childNodes);\n    container.appendChild(fragment);\n  }\n  htmlResult.directives.forEach(directiveData => {\n    directiveData.d(directiveData.n);\n  });\n};\n","const IS_PROXY = Symbol('$P');\nfunction proxify(obj: any, onChange: () => void): any {\n  const proxy = new Proxy(obj, {\n    get: (obj, prop) => {\n      if (\n        obj[prop] &&\n        typeof obj[prop] === 'object' &&\n        obj[prop].__$p !== IS_PROXY\n      ) {\n        obj[prop] = proxify(obj[prop], onChange);\n      }\n      return obj[prop];\n    },\n    set: (obj, prop, value) => {\n      if (obj[prop] !== value && prop !== '__$p') {\n        obj[prop] = value;\n        onChange();\n      }\n      return true;\n    },\n  });\n  proxy.__$p = IS_PROXY;\n  return proxy;\n}\nlet onStateChanged: () => void;\nexport const setUpState = <CB extends () => any>(\n  cb: CB,\n  onChange: () => void\n): ReturnType<CB> => {\n  onStateChanged = onChange;\n  let result = cb();\n  onStateChanged = undefined;\n  return result;\n};\nexport const state = <S extends {} = {}>(initialState: Partial<S> = {}): S => {\n  let onChange = onStateChanged;\n  return proxify(initialState, () => onChange && onChange());\n};\n","export enum PriorityLevel {\n  IMMEDIATE = 0, //synchronous\n  USER_BLOCKING = 250, //.25s timeout\n  NORMAL = 5000, // 5s timeout\n  LOW = 10000, // 10s timeout\n  IDLE = 99999999, // no timeout (run only when nothing else is scheduled)\n}\ntype ScheduledJob = [() => void, number, number];\nlet scheduledJobs: ScheduledJob[] = [];\nlet schedulerRunning: boolean = false;\nconst MAX_ELAPSED: number = 17;\nconst processJobQueue = (\n  queue: ScheduledJob[],\n  now: number\n): ScheduledJob[] => {\n  return queue.filter(([cb, startTime, timeout]) => {\n    const totalElapsed: number = Date.now() - now;\n    const jobElapsed: number = Date.now() - startTime;\n    if (jobElapsed > timeout || totalElapsed < MAX_ELAPSED) {\n      cb();\n      return false;\n    } else {\n      return true;\n    }\n  });\n};\nconst processScheduledJobs = () => {\n  const now: number = Date.now();\n  const jobsToRun = scheduledJobs;\n  scheduledJobs = [];\n  const remainingJobs = processJobQueue(jobsToRun, now);\n  scheduledJobs = remainingJobs.concat(scheduledJobs);\n  if (scheduledJobs.length > 0) {\n    requestAnimationFrame(processScheduledJobs);\n  } else {\n    schedulerRunning = false;\n  }\n};\nexport const schedule = (\n  cb: () => void,\n  priority: PriorityLevel = PriorityLevel.NORMAL\n): Promise<void> => {\n  if (priority === PriorityLevel.IMMEDIATE) {\n    cb();\n  } else {\n    return new Promise(resolve => {\n      scheduledJobs.push([\n        () => {\n          cb();\n          resolve();\n        },\n        Date.now(),\n        priority,\n      ]);\n      if (!schedulerRunning) {\n        requestAnimationFrame(processScheduledJobs);\n        schedulerRunning = true;\n      }\n    });\n  }\n  return Promise.resolve();\n};\nexport type Schedule = typeof schedule;\n","import { HTMLResult } from './html';\nimport { setUpState } from './reactivity';\nimport { render } from './render';\nimport { schedule, PriorityLevel } from './scheduler';\nexport interface ComponentDefinition {\n  render: () => HTMLResult;\n}\nexport type Setup = () => ComponentDefinition;\nexport const component = (name: string, setup: Setup) => {\n  customElements.define(\n    name,\n    class extends HTMLElement {\n      private renderQueued: boolean = false;\n      private render: () => HTMLResult;\n      constructor() {\n        super();\n        this.attachShadow({ mode: 'open' });\n        setUpState(\n          () => (this.render = setup().render),\n          () => {\n            this.performRender();\n          }\n        );\n        this.performRender();\n      }\n\n      private performRender() {\n        if (!this.renderQueued) {\n          this.renderQueued = true;\n          schedule(() => {\n            render(this.shadowRoot as any, this.render());\n          }, PriorityLevel.USER_BLOCKING).then(\n            () => (this.renderQueued = false)\n          );\n        }\n      }\n    }\n  );\n};\n","import { schedule, Schedule } from './scheduler';\n\nexport type Directive<N extends Node = Node, Args extends any[] = any[]> = (\n  ...args: Args\n) => (node: N) => void;\nexport type DirectiveHandler<\n  N extends Node = any,\n  Args extends any[] = any[]\n> = (node: N, schedule: Schedule, ...args: Args) => void;\nexport function createDirective<\n  Args extends any[] = any[],\n  N extends Node = any,\n  D extends DirectiveHandler<N, Args> = DirectiveHandler<N, Args>\n>(\n  handler: D\n): D extends (node: N, schedule: Schedule, ...args: infer A) => void\n  ? Directive<N, A>\n  : never {\n  return ((...args: Args) => {\n    return (node: N) => {\n      handler(node, schedule, ...args);\n    };\n  }) as D extends (node: N, schedule: Schedule, ...args: infer A) => void\n    ? Directive<N, A>\n    : never;\n}\n","import { createDirective } from '../directive';\nimport { Schedule } from '../scheduler';\n\nexport const text = createDirective(\n  (node: Text, schedule: Schedule, value: string) => {\n    if (node instanceof Text) {\n      schedule(() => {\n        node.textContent = value;\n      });\n    }\n  }\n);\n","import { createDirective } from '../directive';\nimport { PriorityLevel, Schedule } from '../scheduler';\n\nconst valueMap: WeakMap<HTMLInputElement, string> = new WeakMap();\nexport const input = createDirective(\n  (node: HTMLInputElement, schedule: Schedule, cb: (value: string) => void) => {\n    if (node instanceof HTMLInputElement) {\n      if (!valueMap.has(node)) {\n        valueMap.set(node, node.value);\n        node.addEventListener('input', e => {\n          const value: string = (e.target as HTMLInputElement).value;\n          if (value !== valueMap.get(node)) {\n            schedule(() => cb(value), PriorityLevel.USER_BLOCKING);\n            valueMap.set(node, value);\n          }\n        });\n      }\n    }\n  }\n);\n"],"names":["isLetter","c","toLowerCase","toUpperCase","DirectiveType","insertAttributeMarker","marker","si","appendedStatic","char","charAt","slice","getTextMarker","id","getAttributeMarker","resultCache","WeakMap","html","staticParts","result","get","dynamicParts","directives","i","length","dynamicPart","staticPart","push","d","attributeValueMode","attributeMode","attributeNameFound","attributeName","nextChar","nextNextChar","t","TEXT","ATTRIBUTE_VALUE","a","ATTRIBUTE","template","document","createElement","innerHTML","directiveIndex","forEach","value","set","childNodesMap","render","container","htmlResult","has","fragment","content","cloneNode","directiveData","placeholder","querySelector","textNode","firstChild","n","parentElement","replaceChild","node","removeAttribute","childNodes","appendChild","IS_PROXY","Symbol","proxify","obj","onChange","proxy","Proxy","prop","__$p","onStateChanged","setUpState","cb","undefined","state","initialState","PriorityLevel","scheduledJobs","schedulerRunning","MAX_ELAPSED","processJobQueue","queue","now","filter","startTime","timeout","totalElapsed","Date","jobElapsed","processScheduledJobs","jobsToRun","remainingJobs","concat","requestAnimationFrame","schedule","priority","NORMAL","IMMEDIATE","Promise","resolve","component","name","setup","customElements","define","attachShadow","mode","performRender","renderQueued","shadowRoot","USER_BLOCKING","then","HTMLElement","createDirective","handler","args","text","Text","textContent","valueMap","input","HTMLInputElement","addEventListener","e","target"],"mappings":"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"}