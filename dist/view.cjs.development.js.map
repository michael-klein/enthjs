{"version":3,"file":"view.cjs.development.js","sources":["../src/directive.ts","../src/html.ts","../src/render.ts","../src/scheduler.ts","../src/directives/sub.ts","../src/reactivity.ts","../src/misc.ts","../src/context.ts","../src/sideeffects.ts","../src/component.ts","../src/properties.ts","../src/attributes.ts","../src/directives/text.ts","../src/directives/input.ts","../src/directives/on.ts"],"sourcesContent":["export type DirectiveGenerator<Args extends any[] = any[]> = Generator<\n  any,\n  void,\n  Args\n>;\n\nexport type DirectiveGeneratorFactory<\n  N extends Node = Node,\n  Args extends any[] = any[]\n> = (node: N, ...initialArgs: Args) => DirectiveGenerator<Args>;\nexport interface DirectiveResult<\n  N extends Node = Node,\n  Args extends any[] = any[]\n> {\n  factory: DirectiveGeneratorFactory<N, Args>;\n  args: Args;\n}\nexport type Directive<N extends Node = Node, Args extends any[] = any[]> = (\n  ...args: Args\n) => DirectiveResult<N, Args>;\nexport const IS_DIRECTIVE = Symbol('directive');\nexport function createDirective<\n  Args extends any[],\n  N extends Node = any,\n  F extends DirectiveGeneratorFactory<N, Args> = DirectiveGeneratorFactory<\n    N,\n    Args\n  >\n>(\n  factory: F\n): F extends (node: N, ...initialArgs: infer A) => DirectiveGenerator<any>\n  ? Directive<N, A>\n  : never {\n  return ((factory: F) => {\n    const directive = function(...args: Args) {\n      return {\n        is: IS_DIRECTIVE,\n        factory,\n        args,\n      };\n    } as any;\n    return directive;\n  })(factory);\n}\n","import { IS_DIRECTIVE, DirectiveResult } from './directive';\n\nconst isLetter = (c: string): boolean => {\n  return c.toLowerCase() != c.toUpperCase();\n};\n\nexport enum DirectiveType {\n  TEXT,\n  ATTRIBUTE,\n  ATTRIBUTE_VALUE,\n}\nexport interface DirectiveData {\n  d: DirectiveResult;\n  t?: DirectiveType;\n  a?: string;\n}\nconst insertAttributeMarker = (\n  marker: string,\n  si: number,\n  appendedStatic: string\n): string => {\n  while (si++) {\n    const char = appendedStatic.charAt(si);\n    if (!char) {\n      break;\n    }\n    if (char === ' ') {\n      return (\n        appendedStatic.slice(0, si) + ' ' + marker + appendedStatic.slice(si)\n      );\n    }\n  }\n  return appendedStatic;\n};\nexport const getTextMarker = (id: number): string => {\n  return `tm-${id}`;\n};\nexport const getAttributeMarker = (id: number): string => {\n  return `data-am-${id}`;\n};\nexport interface HTMLResult {\n  template: HTMLTemplateElement;\n  directives: DirectiveData[];\n}\nfunction isDirective(thing: any): boolean {\n  return thing.is && thing.is === IS_DIRECTIVE;\n}\nlet resultCache: WeakMap<TemplateStringsArray, HTMLResult> = new WeakMap();\nexport const html = (\n  staticParts: TemplateStringsArray,\n  ...dynamicParts: any[]\n): HTMLResult => {\n  let result: HTMLResult = resultCache.get(staticParts);\n  if (!result) {\n    let appendedStatic: string = '';\n    const directives: DirectiveData[] = [];\n    for (let i = 0; i < dynamicParts.length; i++) {\n      const dynamicPart = dynamicParts[i];\n      const staticPart = staticParts[i];\n      appendedStatic += staticPart;\n      if (!isDirective(dynamicPart)) {\n        appendedStatic += dynamicPart;\n        continue;\n      }\n      let id =\n        directives.push({\n          d: dynamicPart,\n        }) - 1;\n      let si = appendedStatic.length + 1;\n      let attributeValueMode = false;\n      let attributeMode = false;\n      let attributeNameFound = false;\n      let attributeName = '';\n      while (si--) {\n        const char = appendedStatic.charAt(si);\n        const nextChar = appendedStatic.charAt(si - 1);\n        const nextNextChar = appendedStatic.charAt(si - 2);\n        if (char === '>' || si === 0) {\n          let marker = getTextMarker(id);\n          appendedStatic += `<${marker}>&zwnj;</${marker}>`;\n          directives[id].t = DirectiveType.TEXT;\n          break;\n        }\n        if (\n          char === '\"' &&\n          nextChar === '=' &&\n          isLetter(nextNextChar) &&\n          !attributeMode\n        ) {\n          attributeValueMode = true;\n          continue;\n        }\n        if (char === '\"' && nextNextChar !== '=' && !attributeValueMode) {\n          attributeValueMode = false;\n          attributeMode = true;\n          continue;\n        }\n        if (\n          attributeValueMode &&\n          char !== '\"' &&\n          char !== '=' &&\n          !attributeNameFound\n        ) {\n          if (char !== ' ') {\n            attributeName = char + attributeName;\n          } else {\n            attributeNameFound = true;\n          }\n        }\n        if (char === '<' && attributeValueMode) {\n          appendedStatic = insertAttributeMarker(\n            getAttributeMarker(id),\n            si,\n            appendedStatic\n          );\n          directives[id].t = DirectiveType.ATTRIBUTE_VALUE;\n          directives[id].a = attributeName;\n          if (appendedStatic[appendedStatic.length - 1] === ' ') {\n            appendedStatic = appendedStatic.slice(0, appendedStatic.length - 1);\n          }\n          break;\n        }\n        if (char === '<' && !attributeValueMode) {\n          appendedStatic = insertAttributeMarker(\n            getAttributeMarker(id),\n            si,\n            appendedStatic\n          );\n          directives[id].t = DirectiveType.ATTRIBUTE;\n          break;\n        }\n      }\n    }\n    appendedStatic += staticParts[staticParts.length - 1];\n    const template = document.createElement('template');\n    template.innerHTML = appendedStatic;\n    result = {\n      template,\n      directives,\n    };\n  } else {\n    let directiveIndex: number = 0;\n    dynamicParts.forEach((value: any) => {\n      if (isDirective(value)) {\n        result.directives[directiveIndex].d = value;\n        directiveIndex++;\n      }\n    });\n  }\n  resultCache.set(staticParts, result);\n  return result;\n};\n","import {\n  HTMLResult,\n  DirectiveType,\n  getTextMarker,\n  getAttributeMarker,\n} from './html';\nimport { DirectiveGenerator } from './directive';\n\nconst renderedNodesMap: WeakMap<HTMLElement, Node[]> = new WeakMap();\nexport const clear = (container: HTMLElement) => {\n  if (renderedNodesMap.has(container)) {\n    renderedNodesMap\n      .get(container)\n      .forEach(node => container.removeChild(node));\n    renderedNodesMap.delete(container);\n  }\n};\nconst generatorMap: WeakMap<HTMLElement, DirectiveGenerator[]> = new WeakMap();\nexport const render = (\n  container: HTMLElement,\n  htmlResult: HTMLResult\n): void => {\n  let fragment: DocumentFragment;\n  if (!renderedNodesMap.has(container)) {\n    const generators: DirectiveGenerator[] = [];\n    generatorMap.set(container, generators);\n    fragment = htmlResult.template.content.cloneNode(true) as DocumentFragment;\n    htmlResult.directives.forEach((directiveData, id) => {\n      switch (directiveData.t) {\n        case DirectiveType.TEXT:\n          const placeholder = fragment.querySelector(getTextMarker(id));\n          const textNode = placeholder.firstChild;\n          generators[id] = directiveData.d.factory(\n            textNode,\n            ...directiveData.d.args\n          );\n          placeholder.parentElement.replaceChild(textNode, placeholder);\n          break;\n        case DirectiveType.ATTRIBUTE:\n        case DirectiveType.ATTRIBUTE_VALUE:\n          const marker = getAttributeMarker(id);\n          const node = fragment.querySelector(`[${marker}]`);\n          generators[id] = directiveData.d.factory(\n            node,\n            ...directiveData.d.args\n          );\n          node.removeAttribute(marker);\n      }\n    });\n    renderedNodesMap.set(container, Array.from(fragment.childNodes));\n  }\n\n  const generators: DirectiveGenerator[] = generatorMap.get(container);\n  htmlResult.directives.forEach((directiveData, id) => {\n    generators[id].next(directiveData.d.args);\n  });\n  if (fragment) {\n    container.appendChild(fragment);\n  }\n};\n","export enum PriorityLevel {\n  IMMEDIATE = 0, //synchronous\n  USER_BLOCKING = 250, //.25s timeout\n  NORMAL = 5000, // 5s timeout\n  LOW = 10000, // 10s timeout\n  IDLE = 99999999, // no timeout (run only when nothing else is scheduled)\n}\ntype ScheduledJob = [() => void, number];\nlet scheduledJobs: ScheduledJob[] = [];\nlet schedulerRunning: boolean = false;\nconst MAX_ELAPSED: number = 17;\nconst processJobQueue = (\n  queue: ScheduledJob[],\n  now: number\n): ScheduledJob[] => {\n  let index = 0;\n  for (let length = queue.length; index < length; index++) {\n    const totalElapsed: number = Date.now() - now;\n    const [cb, latestEndTime] = queue[index];\n    if (now >= latestEndTime || totalElapsed < MAX_ELAPSED) {\n      cb();\n    } else {\n      break;\n    }\n  }\n  return queue.slice(index);\n};\nconst processScheduledJobs = () => {\n  const now: number = Date.now();\n  scheduledJobs = processJobQueue(\n    scheduledJobs.sort((a, b) => (a[1] < b[1] ? -1 : 1)),\n    now\n  );\n  if (scheduledJobs.length > 0) {\n    requestAnimationFrame(processScheduledJobs);\n  } else {\n    schedulerRunning = false;\n  }\n};\nexport const schedule = (\n  cb: () => void,\n  priority: PriorityLevel = PriorityLevel.NORMAL\n): Promise<void> => {\n  if (priority === PriorityLevel.IMMEDIATE) {\n    cb();\n  } else {\n    return new Promise(resolve => {\n      scheduledJobs.push([\n        () => {\n          cb();\n          resolve();\n        },\n        Date.now() + priority,\n      ]);\n      if (!schedulerRunning) {\n        requestAnimationFrame(processScheduledJobs);\n        schedulerRunning = true;\n      }\n    });\n  }\n  return Promise.resolve();\n};\nexport type Schedule = typeof schedule;\n","import { createDirective } from '../directive';\nimport { PriorityLevel, schedule } from '../scheduler';\nimport { HTMLResult } from '../html';\nimport { clear, render } from '../render';\n\nexport const sub = createDirective(function*(node: Text, cb: () => HTMLResult) {\n  let span: HTMLSpanElement;\n  if (node.nodeType === 3) {\n    span = document.createElement('span');\n    node.parentElement.insertBefore(span, node);\n    node.parentElement.removeChild(node);\n    for (;;) {\n      schedule(() => {\n        clear(span as HTMLElement);\n        render(span as HTMLElement, cb());\n      }, PriorityLevel.USER_BLOCKING);\n      cb = (yield)[0];\n    }\n  }\n});\n","const IS_PROXY = Symbol('$P');\nfunction proxify(obj: any, onChange: () => void): any {\n  const proxy = new Proxy(obj, {\n    get: (obj, prop) => {\n      if (\n        obj[prop] &&\n        typeof obj[prop] === 'object' &&\n        obj[prop].__$p !== IS_PROXY\n      ) {\n        obj[prop] = proxify(obj[prop], onChange);\n      }\n      return obj[prop];\n    },\n    set: (obj, prop, value) => {\n      if (obj[prop] !== value && prop !== '__$p') {\n        obj[prop] = value;\n        onChange();\n      }\n      return true;\n    },\n  });\n  proxy.__$p = IS_PROXY;\n  return proxy;\n}\nlet onStateChanged: () => void;\nexport const setUpState = <CB extends () => any>(\n  cb: CB,\n  onChange: () => void\n): ReturnType<CB> => {\n  onStateChanged = onChange;\n  let result = cb();\n  onStateChanged = undefined;\n  return result;\n};\nexport const $state = <S extends {} = {}>(initialState: Partial<S> = {}): S => {\n  let onChange = onStateChanged;\n  return proxify(initialState, () => onChange && onChange());\n};\n","export const getOnlySetupError = (subject: string): string =>\n  `${subject} can only be used during setup!`;\n","import { getOnlySetupError } from './misc';\n\nconst global: { __$c: HTMLElement } = window as any;\n\nexport const setUpContext = (context: HTMLElement, cb: () => void): void => {\n  global.__$c = context;\n  cb();\n  global.__$c = undefined;\n};\n\nexport const getElement = (): HTMLElement => {\n  if (global.__$c) {\n    return global.__$c;\n  } else {\n    throw getOnlySetupError('getElement');\n  }\n};\n","import { getElement } from './context';\nimport { schedule, PriorityLevel } from './scheduler';\n\nexport type CleanUp = () => void;\nexport type SideEffect = () => void | CleanUp;\ninterface SideEffectsMapItem {\n  e: SideEffect;\n  d?: () => any[];\n  p?: any[];\n  c?: CleanUp;\n}\nconst sideEffectsMap: WeakMap<\n  HTMLElement,\n  SideEffectsMapItem[]\n> = new WeakMap();\n\nexport const sideEffect = (effect: () => void, dependencies?: () => any[]) => {\n  const element = getElement();\n  sideEffectsMap.set(\n    element,\n    (sideEffectsMap.get(element) || []).concat({\n      e: effect,\n      d: dependencies,\n    })\n  );\n};\nconst shouldEffectRun = (effectMapItem: SideEffectsMapItem): boolean => {\n  const { d, p } = effectMapItem;\n  let shouldRun: boolean = true;\n  if (d) {\n    const deps = d();\n    if (\n      p &&\n      (deps === p ||\n        (deps.length === p.length &&\n          deps.findIndex((dep, index) => p[index] !== dep))) === -1\n    ) {\n      shouldRun = false;\n    }\n  }\n  return shouldRun;\n};\nexport const runSideEffects = (element: HTMLElement): Promise<void[]> => {\n  const sideEffects = sideEffectsMap.get(element) || [];\n  if (sideEffects.length > 0) {\n    return Promise.all(\n      sideEffects\n        .map(effectMapItem => {\n          const { c } = effectMapItem;\n          if (c && shouldEffectRun(effectMapItem)) {\n            return schedule(() => {\n              c();\n              effectMapItem.c = undefined;\n            }, PriorityLevel.USER_BLOCKING);\n          }\n          return undefined;\n        })\n        .filter(p => p)\n    ).then(() =>\n      Promise.all(\n        sideEffects\n          .map(effectMapItem => {\n            const { e, d } = effectMapItem;\n            let shouldRun: boolean = shouldEffectRun(effectMapItem);\n            if (d) {\n              effectMapItem.p = d();\n            }\n            if (shouldRun) {\n              return schedule(() => {\n                const cleanUp = e();\n                if (cleanUp) {\n                  effectMapItem.c = cleanUp;\n                }\n              }, PriorityLevel.USER_BLOCKING);\n            }\n            return undefined;\n          })\n          .filter(p => p)\n      )\n    );\n  } else {\n    return Promise.resolve([]);\n  }\n};\n","import { HTMLResult } from './html';\nimport { setUpState } from './reactivity';\nimport { render } from './render';\nimport { schedule, PriorityLevel } from './scheduler';\nimport { setUpContext } from './context';\nimport { runSideEffects } from './sideeffects';\nexport interface ComponentDefinition {\n  render: () => HTMLResult;\n}\nexport type Setup = () => ComponentDefinition;\nexport const component = (name: string, setup: Setup) => {\n  customElements.define(\n    name,\n    class extends HTMLElement {\n      private renderQueued: boolean = false;\n      private nextRenderQueued: boolean = false;\n      private render: () => HTMLResult;\n      constructor() {\n        super();\n        this.attachShadow({ mode: 'open' });\n\n        setUpContext(this, () =>\n          setUpState(\n            () => (this.render = setup().render),\n            () => {\n              this.performRender();\n            }\n          )\n        );\n        this.performRender();\n      }\n\n      private performRender() {\n        if (!this.renderQueued) {\n          this.renderQueued = true;\n          schedule(() => {\n            render(this.shadowRoot as any, this.render());\n          }, PriorityLevel.USER_BLOCKING)\n            .then(async () => await runSideEffects(this))\n            .then(() => {\n              this.renderQueued = false;\n              if (this.nextRenderQueued) {\n                this.nextRenderQueued = false;\n                this.performRender();\n              }\n            });\n        } else {\n          this.nextRenderQueued = true;\n        }\n      }\n    }\n  );\n};\n","import { getElement } from './context';\nimport { $state } from './reactivity';\n\nexport const $prop = <T>(name: string, initialValue: T): { value: T } => {\n  const element = getElement() as any;\n  const state = $state({ value: initialValue });\n  Object.defineProperty(element, name, {\n    get: () => state.value,\n    set: (value: any) => {\n      state.value = value;\n    },\n  });\n  return state;\n};\n","import { $state } from './reactivity';\nimport { getElement } from './context';\nimport { sideEffect } from './sideeffects';\n\nconst attributeCallbackMap: WeakMap<\n  HTMLElement,\n  { [key: string]: (() => void)[] }\n> = new Map();\nconst observerMap: WeakMap<HTMLElement, MutationObserver> = new WeakMap();\n\nconst addObserver = (element: HTMLElement): void => {\n  if (!observerMap.has(element)) {\n    const observer = new MutationObserver((mutationsList: MutationRecord[]) => {\n      for (const mutation of mutationsList) {\n        if (mutation.type === 'attributes') {\n          const callbacks =\n            (attributeCallbackMap.get(element) || {})[mutation.attributeName] ||\n            [];\n          callbacks.forEach(cb => cb());\n        }\n      }\n    });\n    observerMap.set(element, observer);\n  }\n};\n\nconst startObserving = (element: HTMLElement) => {\n  if (observerMap.has(element)) {\n    observerMap.get(element).observe(element, { attributes: true });\n  }\n};\n\nconst stopObserving = (element: HTMLElement) => {\n  if (observerMap.has(element)) {\n    observerMap.get(element).disconnect();\n  }\n};\n\nconst observeAttribute = (\n  element: HTMLElement,\n  name: string,\n  cb: () => void\n): void => {\n  if (!attributeCallbackMap.has(element)) {\n    attributeCallbackMap.set(element, {});\n  }\n  if (!attributeCallbackMap.get(element)[name]) {\n    attributeCallbackMap.get(element)[name] = [];\n  }\n  attributeCallbackMap.get(element)[name].push(cb);\n};\n\nexport const $attr = (\n  name: string,\n  initialValue: string = ''\n): { value: string } => {\n  const element = getElement();\n  addObserver(element);\n  observeAttribute(element, name, () => {\n    const value = element.getAttribute(name);\n    if (state.value !== value) {\n      state.value = element.getAttribute(name);\n    }\n  });\n\n  element.setAttribute(name, initialValue);\n\n  const state = $state({ value: element.getAttribute(name) });\n\n  sideEffect(\n    () => {\n      stopObserving(element);\n      element.setAttribute(name, state.value);\n      startObserving(element);\n    },\n    () => [state.value]\n  );\n\n  return state;\n};\n","import { createDirective } from '../directive';\n\nexport const text = createDirective(function*(node: Text, value: string) {\n  for (;;) {\n    node.textContent = value;\n    value = (yield)[0];\n  }\n});\n","import { createDirective } from '../directive';\nimport { PriorityLevel, schedule } from '../scheduler';\n\nexport const input = createDirective(function*(\n  node: HTMLElement,\n  cb: (value: string) => void\n) {\n  const cbRef = {\n    cb,\n  };\n  node.addEventListener('input', e => {\n    const value: string = (e.target as HTMLInputElement).value;\n    schedule(() => cbRef.cb(value), PriorityLevel.NORMAL);\n  });\n  for (;;) {\n    cbRef.cb = (yield)[0];\n  }\n});\n","import { createDirective } from '../directive';\nimport { PriorityLevel, schedule } from '../scheduler';\n\nexport const on = createDirective(function*(\n  node: HTMLElement,\n  name: string,\n  cb: <E extends Event>(e: E) => void\n) {\n  const cbRef = {\n    cb,\n  };\n  node.addEventListener(name, e => {\n    schedule(() => cbRef.cb(e), PriorityLevel.IMMEDIATE);\n  });\n  for (;;) {\n    cbRef.cb = (yield)[1];\n  }\n});\n"],"names":["IS_DIRECTIVE","Symbol","createDirective","factory","directive","args","is","isLetter","c","toLowerCase","toUpperCase","DirectiveType","insertAttributeMarker","marker","si","appendedStatic","char","charAt","slice","getTextMarker","id","getAttributeMarker","isDirective","thing","resultCache","WeakMap","html","staticParts","result","get","dynamicParts","directives","i","length","dynamicPart","staticPart","push","d","attributeValueMode","attributeMode","attributeNameFound","attributeName","nextChar","nextNextChar","t","TEXT","ATTRIBUTE_VALUE","a","ATTRIBUTE","template","document","createElement","innerHTML","directiveIndex","forEach","value","set","renderedNodesMap","clear","container","has","node","removeChild","generatorMap","render","htmlResult","fragment","generators","content","cloneNode","directiveData","placeholder","querySelector","textNode","firstChild","parentElement","replaceChild","removeAttribute","Array","from","childNodes","next","appendChild","PriorityLevel","scheduledJobs","schedulerRunning","MAX_ELAPSED","processJobQueue","queue","now","index","totalElapsed","Date","cb","latestEndTime","processScheduledJobs","sort","b","requestAnimationFrame","schedule","priority","NORMAL","IMMEDIATE","Promise","resolve","sub","nodeType","span","insertBefore","USER_BLOCKING","IS_PROXY","proxify","obj","onChange","proxy","Proxy","prop","__$p","onStateChanged","setUpState","undefined","$state","initialState","getOnlySetupError","subject","global","window","setUpContext","context","__$c","getElement","sideEffectsMap","sideEffect","effect","dependencies","element","concat","e","shouldEffectRun","effectMapItem","p","shouldRun","deps","findIndex","dep","runSideEffects","sideEffects","all","map","filter","then","cleanUp","component","name","setup","customElements","define","attachShadow","mode","performRender","renderQueued","shadowRoot","nextRenderQueued","HTMLElement","$prop","initialValue","state","Object","defineProperty","attributeCallbackMap","Map","observerMap","addObserver","observer","MutationObserver","mutationsList","mutation","type","callbacks","startObserving","observe","attributes","stopObserving","disconnect","observeAttribute","$attr","getAttribute","setAttribute","text","textContent","input","cbRef","addEventListener","target","on"],"mappings":";;;;AAoBO,IAAMA,YAAY;;AAAGC,MAAM,CAAC,WAAD,CAA3B;AACP,SAAgBC,gBAQdC;SAIQ,UAACA,OAAD;QACAC,SAAS,GAAG,SAAZA,SAAY;wCAAYC;QAAAA;;;aACrB;QACLC,EAAE,EAAEN,YADC;QAELG,OAAO,EAAPA,OAFK;QAGLE,IAAI,EAAJA;OAHF;KADF;;WAOOD,SAAP;GARK,CASJD,OATI,CAAP;;;AC/BF,IAAMI,QAAQ,GAAG,SAAXA,QAAW,CAACC,CAAD;SACRA,CAAC,CAACC,WAAF,MAAmBD,CAAC,CAACE,WAAF,EAA1B;CADF;;AAIA,AAAA,IAAYC,aAAZ;;AAAA,WAAYA;EACVA,wCAAA,SAAA;EACAA,6CAAA,cAAA;EACAA,mDAAA,oBAAA;CAHF,EAAYA,aAAa,KAAbA,aAAa,KAAA,CAAzB;;AAUA,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAC5BC,MAD4B,EAE5BC,EAF4B,EAG5BC,cAH4B;SAKrBD,EAAE,EAAT,EAAa;QACLE,KAAI,GAAGD,cAAc,CAACE,MAAf,CAAsBH,EAAtB,CAAb;;QACI,CAACE,KAAL,EAAW;;;;QAGPA,KAAI,KAAK,GAAb,EAAkB;aAEdD,cAAc,CAACG,KAAf,CAAqB,CAArB,EAAwBJ,EAAxB,IAA8B,GAA9B,GAAoCD,MAApC,GAA6CE,cAAc,CAACG,KAAf,CAAqBJ,EAArB,CAD/C;;;;SAKGC,cAAP;CAhBF;;AAkBA,AAAO,IAAMI,aAAa,GAAG,SAAhBA,aAAgB,CAACC,EAAD;iBACdA,EAAb;CADK;AAGP,AAAO,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACD,EAAD;sBACdA,EAAlB;CADK;;AAOP,SAASE,WAAT,CAAqBC,KAArB;SACSA,KAAK,CAACjB,EAAN,IAAYiB,KAAK,CAACjB,EAAN,KAAaN,YAAhC;;;AAEF,IAAIwB,WAAW;;AAA8C,IAAIC,OAAJ,EAA7D;AACA,IAAaC,IAAI,GAAG,SAAPA,IAAO,CAClBC,WADkB;MAIdC,MAAM,GAAeJ,WAAW,CAACK,GAAZ,CAAgBF,WAAhB,CAAzB;;oCAFGG;IAAAA;;;MAGC,CAACF,MAAL,EAAa;QACPb,cAAc,GAAW,EAA7B;QACMgB,UAAU,GAAoB,EAApC;;SACK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,YAAY,CAACG,MAAjC,EAAyCD,CAAC,EAA1C,EAA8C;UACtCE,WAAW,GAAGJ,YAAY,CAACE,CAAD,CAAhC;UACMG,UAAU,GAAGR,WAAW,CAACK,CAAD,CAA9B;MACAjB,cAAc,IAAIoB,UAAlB;;UACI,CAACb,WAAW,CAACY,WAAD,CAAhB,EAA+B;QAC7BnB,cAAc,IAAImB,WAAlB;;;;UAGEd,EAAE,GACJW,UAAU,CAACK,IAAX,CAAgB;QACdC,CAAC,EAAEH;OADL,IAEK,CAHP;UAIIpB,EAAE,GAAGC,cAAc,CAACkB,MAAf,GAAwB,CAAjC;UACIK,kBAAkB,GAAG,KAAzB;UACIC,aAAa,GAAG,KAApB;UACIC,kBAAkB,GAAG,KAAzB;UACIC,aAAa,GAAG,EAApB;;aACO3B,EAAE,EAAT,EAAa;YACLE,MAAI,GAAGD,cAAc,CAACE,MAAf,CAAsBH,EAAtB,CAAb;;YACM4B,QAAQ,GAAG3B,cAAc,CAACE,MAAf,CAAsBH,EAAE,GAAG,CAA3B,CAAjB;YACM6B,YAAY,GAAG5B,cAAc,CAACE,MAAf,CAAsBH,EAAE,GAAG,CAA3B,CAArB;;YACIE,MAAI,KAAK,GAAT,IAAgBF,EAAE,KAAK,CAA3B,EAA8B;cACxBD,MAAM,GAAGM,aAAa,CAACC,EAAD,CAA1B;UACAL,cAAc,UAAQF,MAAR,iBAA0BA,MAA1B,MAAd;UACAkB,UAAU,CAACX,EAAD,CAAV,CAAewB,CAAf,GAAmBjC,aAAa,CAACkC,IAAjC;;;;YAIA7B,MAAI,KAAK,GAAT,IACA0B,QAAQ,KAAK,GADb,IAEAnC,QAAQ,CAACoC,YAAD,CAFR,IAGA,CAACJ,aAJH,EAKE;UACAD,kBAAkB,GAAG,IAArB;;;;YAGEtB,MAAI,KAAK,GAAT,IAAgB2B,YAAY,KAAK,GAAjC,IAAwC,CAACL,kBAA7C,EAAiE;UAC/DA,kBAAkB,GAAG,KAArB;UACAC,aAAa,GAAG,IAAhB;;;;YAIAD,kBAAkB,IAClBtB,MAAI,KAAK,GADT,IAEAA,MAAI,KAAK,GAFT,IAGA,CAACwB,kBAJH,EAKE;cACIxB,MAAI,KAAK,GAAb,EAAkB;YAChByB,aAAa,GAAGzB,MAAI,GAAGyB,aAAvB;WADF,MAEO;YACLD,kBAAkB,GAAG,IAArB;;;;YAGAxB,MAAI,KAAK,GAAT,IAAgBsB,kBAApB,EAAwC;UACtCvB,cAAc,GAAGH,qBAAqB,CACpCS,kBAAkB,CAACD,EAAD,CADkB,EAEpCN,EAFoC,EAGpCC,cAHoC,CAAtC;UAKAgB,UAAU,CAACX,EAAD,CAAV,CAAewB,CAAf,GAAmBjC,aAAa,CAACmC,eAAjC;UACAf,UAAU,CAACX,EAAD,CAAV,CAAe2B,CAAf,GAAmBN,aAAnB;;cACI1B,cAAc,CAACA,cAAc,CAACkB,MAAf,GAAwB,CAAzB,CAAd,KAA8C,GAAlD,EAAuD;YACrDlB,cAAc,GAAGA,cAAc,CAACG,KAAf,CAAqB,CAArB,EAAwBH,cAAc,CAACkB,MAAf,GAAwB,CAAhD,CAAjB;;;;;;YAIAjB,MAAI,KAAK,GAAT,IAAgB,CAACsB,kBAArB,EAAyC;UACvCvB,cAAc,GAAGH,qBAAqB,CACpCS,kBAAkB,CAACD,EAAD,CADkB,EAEpCN,EAFoC,EAGpCC,cAHoC,CAAtC;UAKAgB,UAAU,CAACX,EAAD,CAAV,CAAewB,CAAf,GAAmBjC,aAAa,CAACqC,SAAjC;;;;;;IAKNjC,cAAc,IAAIY,WAAW,CAACA,WAAW,CAACM,MAAZ,GAAqB,CAAtB,CAA7B;QACMgB,QAAQ,GAAGC,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAjB;IACAF,QAAQ,CAACG,SAAT,GAAqBrC,cAArB;IACAa,MAAM,GAAG;MACPqB,QAAQ,EAARA,QADO;MAEPlB,UAAU,EAAVA;KAFF;GAnFF,MAuFO;QACDsB,cAAc,GAAW,CAA7B;IACAvB,YAAY,CAACwB,OAAb,CAAqB,UAACC,KAAD;UACfjC,WAAW,CAACiC,KAAD,CAAf,EAAwB;QACtB3B,MAAM,CAACG,UAAP,CAAkBsB,cAAlB,EAAkChB,CAAlC,GAAsCkB,KAAtC;QACAF,cAAc;;KAHlB;;;EAOF7B,WAAW,CAACgC,GAAZ,CAAgB7B,WAAhB,EAA6BC,MAA7B;SACOA,MAAP;CAtGK;;ACxCP,IAAM6B,gBAAgB;;AAAiC,IAAIhC,OAAJ,EAAvD;AACA,AAAO,IAAMiC,KAAK,GAAG,SAARA,KAAQ,CAACC,SAAD;MACfF,gBAAgB,CAACG,GAAjB,CAAqBD,SAArB,CAAJ,EAAqC;IACnCF,gBAAgB,CACb5B,GADH,CACO8B,SADP,EAEGL,OAFH,CAEW,UAAAO,IAAI;aAAIF,SAAS,CAACG,WAAV,CAAsBD,IAAtB,CAAJ;KAFf;IAGAJ,gBAAgB,UAAhB,CAAwBE,SAAxB;;CALG;AAQP,IAAMI,YAAY;;AAA+C,IAAItC,OAAJ,EAAjE;AACA,IAAauC,MAAM,GAAG,SAATA,MAAS,CACpBL,SADoB,EAEpBM,UAFoB;MAIhBC,QAAJ;;MACI,CAACT,gBAAgB,CAACG,GAAjB,CAAqBD,SAArB,CAAL,EAAsC;QAC9BQ,WAAU,GAAyB,EAAzC;IACAJ,YAAY,CAACP,GAAb,CAAiBG,SAAjB,EAA4BQ,WAA5B;IACAD,QAAQ,GAAGD,UAAU,CAAChB,QAAX,CAAoBmB,OAApB,CAA4BC,SAA5B,CAAsC,IAAtC,CAAX;IACAJ,UAAU,CAAClC,UAAX,CAAsBuB,OAAtB,CAA8B,UAACgB,aAAD,EAAgBlD,EAAhB;;;cACpBkD,aAAa,CAAC1B,CAAtB;aACOjC,aAAa,CAACkC,IAAnB;cACQ0B,WAAW,GAAGL,QAAQ,CAACM,aAAT,CAAuBrD,aAAa,CAACC,EAAD,CAApC,CAApB;cACMqD,QAAQ,GAAGF,WAAW,CAACG,UAA7B;UACAP,WAAU,CAAC/C,EAAD,CAAV,GAAiB,oBAAAkD,aAAa,CAACjC,CAAd,EAAgBlC,OAAhB,0BACfsE,QADe,SAEZH,aAAa,CAACjC,CAAd,CAAgBhC,IAFJ,EAAjB;UAIAkE,WAAW,CAACI,aAAZ,CAA0BC,YAA1B,CAAuCH,QAAvC,EAAiDF,WAAjD;;;aAEG5D,aAAa,CAACqC,SAAnB;aACKrC,aAAa,CAACmC,eAAnB;cACQjC,MAAM,GAAGQ,kBAAkB,CAACD,EAAD,CAAjC;cACMyC,IAAI,GAAGK,QAAQ,CAACM,aAAT,OAA2B3D,MAA3B,OAAb;UACAsD,WAAU,CAAC/C,EAAD,CAAV,GAAiB,qBAAAkD,aAAa,CAACjC,CAAd,EAAgBlC,OAAhB,2BACf0D,IADe,SAEZS,aAAa,CAACjC,CAAd,CAAgBhC,IAFJ,EAAjB;UAIAwD,IAAI,CAACgB,eAAL,CAAqBhE,MAArB;;KAnBN;IAsBA4C,gBAAgB,CAACD,GAAjB,CAAqBG,SAArB,EAAgCmB,KAAK,CAACC,IAAN,CAAWb,QAAQ,CAACc,UAApB,CAAhC;;;MAGIb,UAAU,GAAyBJ,YAAY,CAAClC,GAAb,CAAiB8B,SAAjB,CAAzC;EACAM,UAAU,CAAClC,UAAX,CAAsBuB,OAAtB,CAA8B,UAACgB,aAAD,EAAgBlD,EAAhB;IAC5B+C,UAAU,CAAC/C,EAAD,CAAV,CAAe6D,IAAf,CAAoBX,aAAa,CAACjC,CAAd,CAAgBhC,IAApC;GADF;;MAGI6D,QAAJ,EAAc;IACZP,SAAS,CAACuB,WAAV,CAAsBhB,QAAtB;;CAvCG;;AClBP,IAAYiB,aAAZ;;AAAA,WAAYA;EACVA,6CAAA,cAAA;EACAA,mDAAA,kBAAA;EACAA,6CAAA,WAAA;EACAA,2CAAA,QAAA;EACAA,+CAAA,SAAA;CALF,EAAYA,aAAa,KAAbA,aAAa,KAAA,CAAzB;;AAQA,IAAIC,aAAa,GAAmB,EAApC;AACA,IAAIC,gBAAgB,GAAY,KAAhC;AACA,IAAMC,WAAW,GAAW,EAA5B;;AACA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CACtBC,KADsB,EAEtBC,GAFsB;MAIlBC,KAAK,GAAG,CAAZ;;OACK,IAAIzD,MAAM,GAAGuD,KAAK,CAACvD,MAAxB,EAAgCyD,KAAK,GAAGzD,MAAxC,EAAgDyD,KAAK,EAArD,EAAyD;QACjDC,YAAY,GAAWC,IAAI,CAACH,GAAL,KAAaA,GAA1C;uBAC4BD,KAAK,CAACE,KAAD,CAFsB;QAEhDG,EAFgD;QAE5CC,aAF4C;;QAGnDL,GAAG,IAAIK,aAAP,IAAwBH,YAAY,GAAGL,WAA3C,EAAwD;MACtDO,EAAE;KADJ,MAEO;;;;;SAIFL,KAAK,CAACtE,KAAN,CAAYwE,KAAZ,CAAP;CAdF;;AAgBA,IAAMK,oBAAoB,GAAG,SAAvBA,oBAAuB;MACrBN,GAAG,GAAWG,IAAI,CAACH,GAAL,EAApB;EACAL,aAAa,GAAGG,eAAe,CAC7BH,aAAa,CAACY,IAAd,CAAmB,UAACjD,CAAD,EAAIkD,CAAJ;WAAWlD,CAAC,CAAC,CAAD,CAAD,GAAOkD,CAAC,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf,GAAmB,CAA9B;GAAnB,CAD6B,EAE7BR,GAF6B,CAA/B;;MAIIL,aAAa,CAACnD,MAAd,GAAuB,CAA3B,EAA8B;IAC5BiE,qBAAqB,CAACH,oBAAD,CAArB;GADF,MAEO;IACLV,gBAAgB,GAAG,KAAnB;;CATJ;;AAYA,AAAO,IAAMc,QAAQ,GAAG,SAAXA,QAAW,CACtBN,EADsB,EAEtBO,QAFsB;MAEtBA;IAAAA,WAA0BjB,aAAa,CAACkB;;;MAEpCD,QAAQ,KAAKjB,aAAa,CAACmB,SAA/B,EAA0C;IACxCT,EAAE;GADJ,MAEO;WACE,IAAIU,OAAJ,CAAY,UAAAC,OAAO;MACxBpB,aAAa,CAAChD,IAAd,CAAmB,CACjB;QACEyD,EAAE;QACFW,OAAO;OAHQ,EAKjBZ,IAAI,CAACH,GAAL,KAAaW,QALI,CAAnB;;UAOI,CAACf,gBAAL,EAAuB;QACrBa,qBAAqB,CAACH,oBAAD,CAArB;QACAV,gBAAgB,GAAG,IAAnB;;KAVG,CAAP;;;SAcKkB,OAAO,CAACC,OAAR,EAAP;CArBK;;IClCMC,GAAG;;AAAGvG,eAAe;;AAAA,wBAAC,iBAAU2D,IAAV,EAAsBgC,EAAtB;;;;;;gBAE7BhC,IAAI,CAAC6C,QAAL,KAAkB,CAFW;;;;;UAG/BC,IAAI,GAAGzD,QAAQ,CAACC,aAAT,CAAuB,MAAvB,CAAP;UACAU,IAAI,CAACc,aAAL,CAAmBiC,YAAnB,CAAgCD,IAAhC,EAAsC9C,IAAtC;UACAA,IAAI,CAACc,aAAL,CAAmBb,WAAnB,CAA+BD,IAA/B;;;UAEEsC,QAAQ,CAAC;YACPzC,KAAK,CAACiD,IAAD,CAAL;YACA3C,MAAM,CAAC2C,IAAD,EAAsBd,EAAE,EAAxB,CAAN;WAFM,EAGLV,aAAa,CAAC0B,aAHT,CAAR;;;;;UAIAhB,EAX6B,iBAWhB,CAXgB;;;;;;;;;;;;CAAD,EAA3B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACLP,IAAMiB,QAAQ;;AAAG7G,MAAM,CAAC,IAAD,CAAvB;;AACA,SAAS8G,OAAT,CAAiBC,GAAjB,EAA2BC,QAA3B;MACQC,KAAK,GAAG,IAAIC,KAAJ,CAAUH,GAAV,EAAe;IAC3BnF,GAAG,EAAE,aAACmF,GAAD,EAAMI,IAAN;UAEDJ,GAAG,CAACI,IAAD,CAAH,IACA,OAAOJ,GAAG,CAACI,IAAD,CAAV,KAAqB,QADrB,IAEAJ,GAAG,CAACI,IAAD,CAAH,CAAUC,IAAV,KAAmBP,QAHrB,EAIE;QACAE,GAAG,CAACI,IAAD,CAAH,GAAYL,OAAO,CAACC,GAAG,CAACI,IAAD,CAAJ,EAAYH,QAAZ,CAAnB;;;aAEKD,GAAG,CAACI,IAAD,CAAV;KATyB;IAW3B5D,GAAG,EAAE,aAACwD,GAAD,EAAMI,IAAN,EAAY7D,KAAZ;UACCyD,GAAG,CAACI,IAAD,CAAH,KAAc7D,KAAd,IAAuB6D,IAAI,KAAK,MAApC,EAA4C;QAC1CJ,GAAG,CAACI,IAAD,CAAH,GAAY7D,KAAZ;QACA0D,QAAQ;;;aAEH,IAAP;;GAhBU,CAAd;EAmBAC,KAAK,CAACG,IAAN,GAAaP,QAAb;SACOI,KAAP;;;AAEF,IAAII,cAAJ;AACA,IAAaC,UAAU,GAAG,SAAbA,UAAa,CACxB1B,EADwB,EAExBoB,QAFwB;EAIxBK,cAAc,GAAGL,QAAjB;MACIrF,MAAM,GAAGiE,EAAE,EAAf;EACAyB,cAAc,GAAGE,SAAjB;SACO5F,MAAP;CAPK;AASP,IAAa6F,MAAM,GAAG,SAATA,MAAS,CAAoBC,YAApB;MAAoBA;IAAAA,eAA2B;;;MAC/DT,QAAQ,GAAGK,cAAf;SACOP,OAAO,CAACW,YAAD,EAAe;WAAMT,QAAQ,IAAIA,QAAQ,EAA1B;GAAf,CAAd;CAFK;;AClCA,IAAMU,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,OAAD;SAC5BA,OAD4B;CAA1B;;ACEP,IAAMC,MAAM,GAA0BC,MAAtC;AAEA,AAAO,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,OAAD,EAAuBnC,EAAvB;EAC1BgC,MAAM,CAACI,IAAP,GAAcD,OAAd;EACAnC,EAAE;EACFgC,MAAM,CAACI,IAAP,GAAcT,SAAd;CAHK;AAMP,IAAaU,UAAU,GAAG,SAAbA,UAAa;MACpBL,MAAM,CAACI,IAAX,EAAiB;WACRJ,MAAM,CAACI,IAAd;GADF,MAEO;UACCN,iBAAiB,CAAC,YAAD,CAAvB;;CAJG;;ACCP,IAAMQ,cAAc;;AAGhB,IAAI1G,OAAJ,EAHJ;AAKA,IAAa2G,UAAU,GAAG,SAAbA,UAAa,CAACC,MAAD,EAAqBC,YAArB;MAClBC,OAAO,GAAGL,UAAU,EAA1B;EACAC,cAAc,CAAC3E,GAAf,CACE+E,OADF,EAEE,CAACJ,cAAc,CAACtG,GAAf,CAAmB0G,OAAnB,KAA+B,EAAhC,EAAoCC,MAApC,CAA2C;IACzCC,CAAC,EAAEJ,MADsC;IAEzChG,CAAC,EAAEiG;GAFL,CAFF;CAFK;;AAUP,IAAMI,eAAe,GAAG,SAAlBA,eAAkB,CAACC,aAAD;MACdtG,IAASsG,cAATtG;MAAGuG,IAAMD,cAANC;MACPC,SAAS,GAAY,IAAzB;;MACIxG,CAAJ,EAAO;QACCyG,IAAI,GAAGzG,CAAC,EAAd;;QAEEuG,CAAC,IACD,CAACE,IAAI,KAAKF,CAAT,IACEE,IAAI,CAAC7G,MAAL,KAAgB2G,CAAC,CAAC3G,MAAlB,IACC6G,IAAI,CAACC,SAAL,CAAe,UAACC,GAAD,EAAMtD,KAAN;aAAgBkD,CAAC,CAAClD,KAAD,CAAD,KAAasD,GAA7B;KAAf,CAFJ,MAE2D,CAAC,CAJ9D,EAKE;MACAH,SAAS,GAAG,KAAZ;;;;SAGGA,SAAP;CAdF;;AAgBA,AAAO,IAAMI,cAAc,GAAG,SAAjBA,cAAiB,CAACV,OAAD;MACtBW,WAAW,GAAGf,cAAc,CAACtG,GAAf,CAAmB0G,OAAnB,KAA+B,EAAnD;;MACIW,WAAW,CAACjH,MAAZ,GAAqB,CAAzB,EAA4B;WACnBsE,OAAO,CAAC4C,GAAR,CACLD,WAAW,CACRE,GADH,CACO,UAAAT,aAAa;UACRnI,IAAMmI,cAANnI;;UACJA,CAAC,IAAIkI,eAAe,CAACC,aAAD,CAAxB,EAAyC;eAChCxC,QAAQ,CAAC;UACd3F,CAAC;UACDmI,aAAa,CAACnI,CAAd,GAAkBgH,SAAlB;SAFa,EAGZrC,aAAa,CAAC0B,aAHF,CAAf;;;aAKKW,SAAP;KATJ,EAWG6B,MAXH,CAWU,UAAAT,CAAC;aAAIA,CAAJ;KAXX,CADK,EAaLU,IAbK,CAaA;aACL/C,OAAO,CAAC4C,GAAR,CACED,WAAW,CACRE,GADH,CACO,UAAAT,aAAa;YACRF,IAASE,cAATF;YAAGpG,IAAMsG,cAANtG;YACPwG,SAAS,GAAYH,eAAe,CAACC,aAAD,CAAxC;;YACItG,CAAJ,EAAO;UACLsG,aAAa,CAACC,CAAd,GAAkBvG,CAAC,EAAnB;;;YAEEwG,SAAJ,EAAe;iBACN1C,QAAQ,CAAC;gBACRoD,OAAO,GAAGd,CAAC,EAAjB;;gBACIc,OAAJ,EAAa;cACXZ,aAAa,CAACnI,CAAd,GAAkB+I,OAAlB;;WAHW,EAKZpE,aAAa,CAAC0B,aALF,CAAf;;;eAOKW,SAAP;OAfJ,EAiBG6B,MAjBH,CAiBU,UAAAT,CAAC;eAAIA,CAAJ;OAjBX,CADF,CADK;KAbA,CAAP;GADF,MAoCO;WACErC,OAAO,CAACC,OAAR,CAAgB,EAAhB,CAAP;;CAvCG;;IChCMgD,SAAS,GAAG,SAAZA,SAAY,CAACC,IAAD,EAAeC,KAAf;EACvBC,cAAc,CAACC,MAAf,CACEH,IADF;;;;;;;;;wBAGY,GAAwB,KAAxB;4BACA,GAA4B,KAA5B;;YAIDI,YAAL,CAAkB;QAAEC,IAAI,EAAE;OAA1B;;MAEA/B,YAAY,gCAAO;eACjBR,UAAU,CACR;iBAAO,MAAKvD,MAAL,GAAc0F,KAAK,GAAG1F,MAA7B;SADQ,EAER;gBACO+F,aAAL;SAHM,CADO;OAAP,CAAZ;;YAQKA,aAAL;;;;;;;WAGMA,aArBZ,GAqBY;mBAMqC;;;;UALvC,CAAC,KAAKC,YAAV,EAAwB;aACjBA,YAAL,GAAoB,IAApB;QACA7D,QAAQ,CAAC;UACPnC,MAAM,CAAC,MAAI,CAACiG,UAAN,EAAyB,MAAI,CAACjG,MAAL,EAAzB,CAAN;SADM,EAELmB,aAAa,CAAC0B,aAFT,CAAR,CAGGyC,IAHH;;mCAG0BL,cAAc,QAHxC;;;;WAIGK,IAJH,CAIQ;UACJ,MAAI,CAACU,YAAL,GAAoB,KAApB;;cACI,MAAI,CAACE,gBAAT,EAA2B;YACzB,MAAI,CAACA,gBAAL,GAAwB,KAAxB;;YACA,MAAI,CAACH,aAAL;;SARN;OAFF,MAaO;aACAG,gBAAL,GAAwB,IAAxB;;KApCR;;;qBAEgBC,WAFhB;CADK;;ICPMC,KAAK,GAAG,SAARA,KAAQ,CAAIX,IAAJ,EAAkBY,YAAlB;MACb9B,OAAO,GAAGL,UAAU,EAA1B;MACMoC,KAAK,GAAG7C,MAAM,CAAC;IAAElE,KAAK,EAAE8G;GAAV,CAApB;EACAE,MAAM,CAACC,cAAP,CAAsBjC,OAAtB,EAA+BkB,IAA/B,EAAqC;IACnC5H,GAAG,EAAE;aAAMyI,KAAK,CAAC/G,KAAZ;KAD8B;IAEnCC,GAAG,EAAE,aAACD,KAAD;MACH+G,KAAK,CAAC/G,KAAN,GAAcA,KAAd;;GAHJ;SAMO+G,KAAP;CATK;;ACCP,IAAMG,oBAAoB;;AAGtB,IAAIC,GAAJ,EAHJ;AAIA,IAAMC,WAAW;;AAA2C,IAAIlJ,OAAJ,EAA5D;;AAEA,IAAMmJ,WAAW,GAAG,SAAdA,WAAc,CAACrC,OAAD;MACd,CAACoC,WAAW,CAAC/G,GAAZ,CAAgB2E,OAAhB,CAAL,EAA+B;QACvBsC,QAAQ,GAAG,IAAIC,gBAAJ,CAAqB,UAACC,aAAD;2BACbA,aAAvB,kHAAsC;;;;;;;;;;;;YAA3BC,QAA2B;;YAChCA,QAAQ,CAACC,IAAT,KAAkB,YAAtB,EAAoC;cAC5BC,SAAS,GACb,CAACT,oBAAoB,CAAC5I,GAArB,CAAyB0G,OAAzB,KAAqC,EAAtC,EAA0CyC,QAAQ,CAACvI,aAAnD,KACA,EAFF;UAGAyI,SAAS,CAAC5H,OAAV,CAAkB,UAAAuC,EAAE;mBAAIA,EAAE,EAAN;WAApB;;;KANW,CAAjB;IAUA8E,WAAW,CAACnH,GAAZ,CAAgB+E,OAAhB,EAAyBsC,QAAzB;;CAZJ;;AAgBA,IAAMM,cAAc,GAAG,SAAjBA,cAAiB,CAAC5C,OAAD;MACjBoC,WAAW,CAAC/G,GAAZ,CAAgB2E,OAAhB,CAAJ,EAA8B;IAC5BoC,WAAW,CAAC9I,GAAZ,CAAgB0G,OAAhB,EAAyB6C,OAAzB,CAAiC7C,OAAjC,EAA0C;MAAE8C,UAAU,EAAE;KAAxD;;CAFJ;;AAMA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAAC/C,OAAD;MAChBoC,WAAW,CAAC/G,GAAZ,CAAgB2E,OAAhB,CAAJ,EAA8B;IAC5BoC,WAAW,CAAC9I,GAAZ,CAAgB0G,OAAhB,EAAyBgD,UAAzB;;CAFJ;;AAMA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CACvBjD,OADuB,EAEvBkB,IAFuB,EAGvB5D,EAHuB;MAKnB,CAAC4E,oBAAoB,CAAC7G,GAArB,CAAyB2E,OAAzB,CAAL,EAAwC;IACtCkC,oBAAoB,CAACjH,GAArB,CAAyB+E,OAAzB,EAAkC,EAAlC;;;MAEE,CAACkC,oBAAoB,CAAC5I,GAArB,CAAyB0G,OAAzB,EAAkCkB,IAAlC,CAAL,EAA8C;IAC5CgB,oBAAoB,CAAC5I,GAArB,CAAyB0G,OAAzB,EAAkCkB,IAAlC,IAA0C,EAA1C;;;EAEFgB,oBAAoB,CAAC5I,GAArB,CAAyB0G,OAAzB,EAAkCkB,IAAlC,EAAwCrH,IAAxC,CAA6CyD,EAA7C;CAXF;;AAcA,IAAa4F,KAAK,GAAG,SAARA,KAAQ,CACnBhC,IADmB,EAEnBY,YAFmB;MAEnBA;IAAAA,eAAuB;;;MAEjB9B,OAAO,GAAGL,UAAU,EAA1B;EACA0C,WAAW,CAACrC,OAAD,CAAX;EACAiD,gBAAgB,CAACjD,OAAD,EAAUkB,IAAV,EAAgB;QACxBlG,KAAK,GAAGgF,OAAO,CAACmD,YAAR,CAAqBjC,IAArB,CAAd;;QACIa,KAAK,CAAC/G,KAAN,KAAgBA,KAApB,EAA2B;MACzB+G,KAAK,CAAC/G,KAAN,GAAcgF,OAAO,CAACmD,YAAR,CAAqBjC,IAArB,CAAd;;GAHY,CAAhB;EAOAlB,OAAO,CAACoD,YAAR,CAAqBlC,IAArB,EAA2BY,YAA3B;MAEMC,KAAK,GAAG7C,MAAM,CAAC;IAAElE,KAAK,EAAEgF,OAAO,CAACmD,YAAR,CAAqBjC,IAArB;GAAV,CAApB;EAEArB,UAAU,CACR;IACEkD,aAAa,CAAC/C,OAAD,CAAb;IACAA,OAAO,CAACoD,YAAR,CAAqBlC,IAArB,EAA2Ba,KAAK,CAAC/G,KAAjC;IACA4H,cAAc,CAAC5C,OAAD,CAAd;GAJM,EAMR;WAAM,CAAC+B,KAAK,CAAC/G,KAAP,CAAN;GANQ,CAAV;SASO+G,KAAP;CA1BK;;IClDMsB,IAAI;;AAAG1L,eAAe;;AAAA,wBAAC,iBAAU2D,IAAV,EAAsBN,KAAtB;;;;;UAEhCM,IAAI,CAACgI,WAAL,GAAmBtI,KAAnB;;;;;UACAA,KAHgC,iBAGhB,CAHgB;;;;;;;;;;;;CAAD,EAA5B;;ICCMuI,KAAK;;AAAG5L,eAAe;;AAAA,wBAAC,iBACnC2D,IADmC,EAEnCgC,EAFmC;;;;;;UAI7BkG,KAJ6B,GAIrB;YACZlG,EAAE,EAAFA;WALiC;UAOnChC,IAAI,CAACmI,gBAAL,CAAsB,OAAtB,EAA+B,UAAAvD,CAAC;gBACxBlF,KAAK,GAAYkF,CAAC,CAACwD,MAAF,CAA8B1I,KAArD;YACA4C,QAAQ,CAAC;qBAAM4F,KAAK,CAAClG,EAAN,CAAStC,KAAT,CAAN;aAAD,EAAwB4B,aAAa,CAACkB,MAAtC,CAAR;WAFF;;;;;;;UAKE0F,KAAK,CAAClG,EAZ2B,iBAYd,CAZc;;;;;;;;;;;;CAAD,EAA7B;;ICAMqG,EAAE;;AAAGhM,eAAe;;AAAA,wBAAC,iBAChC2D,IADgC,EAEhC4F,IAFgC,EAGhC5D,EAHgC;;;;;;UAK1BkG,KAL0B,GAKlB;YACZlG,EAAE,EAAFA;WAN8B;UAQhChC,IAAI,CAACmI,gBAAL,CAAsBvC,IAAtB,EAA4B,UAAAhB,CAAC;YAC3BtC,QAAQ,CAAC;qBAAM4F,KAAK,CAAClG,EAAN,CAAS4C,CAAT,CAAN;aAAD,EAAoBtD,aAAa,CAACmB,SAAlC,CAAR;WADF;;;;;;;UAIEyF,KAAK,CAAClG,EAZwB,iBAYX,CAZW;;;;;;;;;;;;CAAD,EAA1B;;;;;;;;;;;;;;;;;"}