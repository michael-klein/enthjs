function aa(e,a,l,g){var u;a[0]=0;for(var t=1;t<a.length;t++){var d=a[t++],k=a[t]?(a[0]|=d?1:2,l[a[t++]]):a[++t];3===d?g[0]=k:4===d?g[1]=Object.assign(g[1]||{},k):5===d?(g[1]=g[1]||{})[a[++t]]=k:6===d?g[1][a[++t]]+=k+"":d?(u=e.apply(k,aa(e,k,l,["",null])),g.push(u),k[0]?a[0]|=2:(a[t-2]=0,a[t]=u)):g.push(k)}return g}var ba=new Map;let v=new WeakSet;
function K(e,a){let l=!1,g=()=>{l&&a()};Object.keys(e).forEach(g=>{"object"!==typeof e[g]||v.has(e[g])||(e[g]=K(e[g],a))});let u=new Proxy(e,{get:(a,d)=>a[d],set:(e,d,k)=>{"object"!==typeof k||v.has(k)||(k=K(k,g));e[d]===k&&l||"__$p"===d||"on"===d||(e[d]=k,l&&a());e[d]=k;return!0}});v.add(u);l=!0;return u}var L,P=void 0;
(L=(P={exports:{}},function(e,a){function l(b){if(!b)throw Error("Expected value to be defined");return b}function g(b){if(!R)throw Error("Cannot call "+b+"() unless in patch.");}function u(b){if(E)throw Error(b+"() can not be called between elementOpenStart() and elementOpenEnd().");}function t(b){if(S)throw Error(b+"() may not be called inside an element that has called skip().");}function d(b){if(!E)throw Error(b+"() can only be called after calling elementOpenStart().");}function k(b){let c=E;
E=b;return c}function w(b){let c=S;S=b;return c}function n(){}function p(b,c){for(;b.length>c;)b.pop()}function z(b,c,f){if(null==f)b.removeAttribute(c);else{var a=0===c.lastIndexOf("xml:",0)?"http://www.w3.org/XML/1998/namespace":0===c.lastIndexOf("xlink:",0)?"http://www.w3.org/1999/xlink":null;a?b.setAttributeNS(a,c,String(f)):b.setAttribute(c,String(f))}}function A(b,c,f){(F[c]||F[T.default])(b,c,f)}function U(b,c,f,a){c=new Ba(c,f,a);return b.__incrementalDOMData=c}function x(b,c){if(b.__incrementalDOMData)return b.__incrementalDOMData;
var f=1===b.nodeType?b.localName:b.nodeName,a=da;a=1===b.nodeType&&null!=a?b.getAttribute(a):null;c=U(b,f,1===b.nodeType?a||c:null);if(1===b.nodeType&&(f=b.attributes,a=f.length)){b=c.getAttrsArr(a);for(let c=0,h=0;c<a;c+=1,h+=2){let a=f[c],d=a.value;b[h]=a.name;b[h+1]=d}}return c}function ea(b){x(b);for(b=b.firstChild;b;b=b.nextSibling)ea(b)}function fa(b){b.__incrementalDOMData=null;for(b=b.firstChild;b;b=b.nextSibling)fa(b)}function ha(b,c,a,h,d){return c==a&&h==d}function ia(b,c,a){for(;c!==a;){let a=
c.nextSibling;b.removeChild(c);y.markDeleted(c);c=a}}function M(){return m?m.nextSibling:q.firstChild}function ja(){ia(q,M(),null);m=q;q=q.parentNode}function ka(){m=M()}function V(b,c){ka();a:{if(m){var a=m;do{{var h=a;var d=b,g=c;let f=x(h,g);h=N(h,d,f.nameOrCtor,g,f.key)}if(h)break a}while(c&&(a=a.nextSibling))}a=null}a||("#text"===b?(b=G.createTextNode(""),U(b,"#text",null)):(a=G,h=q,a="function"===typeof b?new b:(h="svg"===b?"http://www.w3.org/2000/svg":"math"===b?"http://www.w3.org/1998/Math/MathML":
null==h||"foreignObject"===x(h,void 0).nameOrCtor?null:h.namespaceURI)?a.createElementNS(h,b):a.createElement(b),U(a,b,c),b=a),y.markCreated(b),a=b);b=a;if(b!==m){if(0<=O.indexOf(b))for(c=q,a=b.nextSibling,h=m;null!==h&&h!==b;)d=h.nextSibling,c.insertBefore(h,a),h=d;else q.insertBefore(b,m);m=b}}function la(b,c){V(b,c);q=m;m=null;return q}function ma(){w(!1);ja();return m}function W(){g("currentElement");u("currentElement");return q}function na(b,c={}){let {matches:a=ha}=c;return(c,f,d)=>{const h=
y,g=G,e=O,u=C,t=H,Ca=m,n=q,A=N;G=c.ownerDocument;y=new Da;N=a;C=[];H=[];m=null;q=c.parentNode;var B=q;var p;var r=Ea.call(c);if((p=11===r.nodeType||9===r.nodeType?r.activeElement:null)&&c.contains(p)){for(r=[];p!==B;)p=l(p),r.push(p),p=p.parentNode;B=r}else B=[];O=B;B=k(!1);r=w(!1);R=null!=y;try{const a=b(c,f,d);if(E)throw Error("elementOpenEnd() must be called after calling elementOpenStart().");return a}finally{y.notifyChanges(),G=g,y=h,N=A,C=u,H=t,m=Ca,q=n,O=e,k(B),w(r),R=null!=y}}}function oa(b){return na((b,
a,h)=>{q=m=b;m=null;a(h);ja();if(m!==b){a=m;for(h=[];a&&a!==b;)h.push(a.nodeName.toLowerCase()),a=a.parentNode;throw Error("One or more tags were not closed:\n"+h.join("\n"));}return b},b)}function pa(b){return na((b,a,h)=>{let c={nextSibling:b},f,d;f=b.nextSibling;d=b.previousSibling;m=c;a(h);q||console.warn("patchOuter requires the node have a parent if there is a key.");{h=m;a=l(c);h=l(h);let b=h.nextSibling===a.nextSibling&&h.previousSibling===d;if((h.nextSibling!==f||h.previousSibling!==d)&&
!b&&h!==a)throw Error("There must be exactly one top level call corresponding to the patched element.");}q&&ia(q,M(),b.nextSibling);return c===m?null:m},b)}function X(b,a,f,h){r.push(b);r.push(a);r.push(f);r.push(h)}function qa(b,a){let c=H;{a=a.getAttrsArr(c.length);var h=!a.length;let f=0;for(;f<c.length;f+=2){var d=c[f];if(h)a[f]=d;else if(a[f]!==d)break;let g=c[f+1];if(h||a[f+1]!==g)a[f+1]=g,X(A,b,d,g)}if(f<c.length||f<a.length){for(f=h=f;f<a.length;f+=2)I[a[f]]=a[f+1];for(f=h;f<c.length;f+=2)h=
c[f],d=c[f+1],I[h]!==d&&X(A,b,h,d),a[f]=h,a[f+1]=d,delete I[h];p(a,c.length);for(var g in I)X(A,b,g,void 0),delete I[g]}b=Y;Y=g=r.length;for(a=b;a<g;a+=4)(0,r[a])(r[a+1],r[a+2],r[a+3]);Y=b;p(r,b)}p(c,0)}function ra(b,a,f){if(!a.staticsApplied&&(a.staticsApplied=!0,f&&f.length))if(a.hasEmptyAttrsArr())for(var c=0;c<f.length;c+=2)A(b,f[c],f[c+1]);else{for(var d=0;d<f.length;d+=2)D[f[d]]=d+1;a=a.getAttrsArr(0);d=0;for(let b=0;b<a.length;b+=2){let c=a[b],h=a[b+1],g=D[c];g?f[g]===h&&delete D[c]:(a[d]=
c,a[d+1]=h,d+=2)}p(a,d);for(c in D)A(b,c,f[D[c]]),delete D[c]}}function sa(a,c,f){let b=C;u("elementOpenStart");k(!0);b[0]=a;b[1]=c;b[2]=f}function ta(a,c){let b=H;g("attr");b.push(a);b.push(c)}function ua(){let a=C;d("elementOpenEnd");k(!1);let c=la(a[0],a[1]),f=x(c,void 0);ra(c,f,a[2]);qa(c,f);p(a,0);return c}function va(a,c,f,...d){u("elementOpen");t("elementOpen");sa(a,c,f);for(d=3;d<arguments.length;d+=2)ta(arguments[d],arguments[d+1]);return ua()}function wa(a){u("elementClose");let b=ma();
var f=x(b,void 0).nameOrCtor;if(f!==a)throw Error('Received a call to close "'+a+'" but "'+f+'" was open.');return b}Object.defineProperty(a,"__esModule",{value:!0});let da="key",E=!1,S=!1,R=!1,Fa=Object.prototype.hasOwnProperty;n.prototype=Object.create(null);let T={default:"__default"},F=new n;F[T.default]=function(a,c,f){let b=typeof f;"object"===b||"function"===b?a[c]=f:z(a,c,f)};F.style=function(a,c,f){l("style"in a);a=a.style;if("string"===typeof f)a.cssText=f;else{a.cssText="";for(let g in f)if(Fa.call(f,
g)){c=a;var b=g,d=f[g];0<=b.indexOf("-")?c.setProperty(b,d):c[b]=d}}};let J={nodesCreated:null,nodesDeleted:null};class Da{constructor(){this.created=[];this.deleted=[]}markCreated(a){this.created.push(a)}markDeleted(a){this.deleted.push(a)}notifyChanges(){J.nodesCreated&&0<this.created.length&&J.nodesCreated(this.created);J.nodesDeleted&&0<this.deleted.length&&J.nodesDeleted(this.deleted)}}let Ea="undefined"!==typeof Node&&Node.prototype.getRootNode||function(){let a=this,c=a;for(;a;)c=a,a=a.parentNode;
return c};class Ba{constructor(a,c,d){this._attrsArr=null;this.staticsApplied=!1;this.nameOrCtor=a;this.key=c;this.text=d}hasEmptyAttrsArr(){let a=this._attrsArr;return!a||!a.length}getAttrsArr(a){var b;(b=this._attrsArr)||(a=Array(a),p(a,0),b=this._attrsArr=a);return b}}let y=null,m=null,q=null,G=null,O=[],N=ha,C=[],H=[];e=oa();let Ga=pa(),r=[],Y=0,I=new n,D=new n;a.applyAttr=z;a.applyProp=function(a,c,d){a[c]=d};a.attributes=F;a.alignWithDOM=V;a.close=ma;a.createPatchInner=oa;a.createPatchOuter=
pa;a.currentElement=W;a.currentPointer=function(){g("currentPointer");u("currentPointer");return M()};a.open=la;a.patch=e;a.patchInner=e;a.patchOuter=Ga;a.skip=function(){if(null!==m)throw Error("skip() must come before any child declarations inside the current element.");w(!0);m=q.lastChild};a.skipNode=ka;a.setKeyAttributeName=function(a){da=a};a.clearCache=fa;a.getKey=function(a){l(a.__incrementalDOMData);return x(a,void 0).key};a.importNode=ea;a.isDataInitialized=function(a){return!!a.__incrementalDOMData};
a.notifications=J;a.symbols=T;a.applyAttrs=function(){let a=W(),c=x(a,void 0);qa(a,c)};a.applyStatics=function(a){let b=W(),d=x(b,void 0);ra(b,d,a)};a.attr=ta;a.elementClose=wa;a.elementOpen=va;a.elementOpenEnd=ua;a.elementOpenStart=sa;a.elementVoid=function(a,c,d,...g){va.apply(null,arguments);return wa(a)};a.key=function(a){let b=C;d("key");l(b);b[1]=a};a.text=function(a,...c){u("text");t("text");V("#text",null);c=m;var b=x(c,void 0);if(b.text!==a){b=b.text=a;for(let a=1;a<arguments.length;a+=1)b=
(0,arguments[a])(b);c.data!==b&&(c.data=b)}return c}}(P,P.exports),P.exports))&&L.__esModule&&Object.prototype.hasOwnProperty.call(L,"default");var ca=L.currentElement,xa=L.currentPointer,ya=L.patch,za=L.skipNode,Aa=L.notifications,Ha=L.elementClose,Ia=L.elementOpen,Ja=L.text;
let Ka=Symbol.for("component"),Q=[],Z=!1,La={IMMEDIATE:0,USER_BLOCKING:250,NORMAL:5E3,LOW:1E4,IDLE:99999999},Ma=(e,a)=>{let l=0;for(let g=e.length;l<g;l++){const g=Date.now()-a,[t,d]=e[l];if(a>=d||17>g)t();else break}return e.slice(l)},Na=()=>{const e=Date.now();Q=Ma(Q.sort((a,e)=>a[1]<e[1]?-1:1),e);0<Q.length?requestAnimationFrame(Na):Z=!1},Oa=(e,a=La.NORMAL)=>{if(a===La.IMMEDIATE)e();else return new Promise(l=>{Q.push([()=>{e();l()},Date.now()+a]);Z||(requestAnimationFrame(Na),Z=!0)});return Promise.resolve()};
Aa.nodesDeleted=function(e){e.forEach(function(a){console.log("removed",a)})};
let Pa=function(e){var a=ba.get(this);return a||(a=new Map,ba.set(this,a)),1<(a=aa(this,a.get(e)||(a.set(e,a=function(a){function g(a){1===d&&(a||(k=k.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?n.push(0,a,k):3===d&&(a||k)?(n.push(3,a,k),d=2):2===d&&"..."===k&&a?n.push(4,a,0):2===d&&k&&!a?n.push(5,0,!0,k):5<=d&&((k||!a&&5===d)&&(n.push(d,0,k,l),d=6),a&&(n.push(d,a,0,l),d=6));k=""}for(var e,l,d=1,k="",w="",n=[0],p=0;p<a.length;p++){p&&(1===d&&g(),g(p));for(var z=0;z<a[p].length;z++)e=a[p][z],1===d?"<"===
e?(g(),n=[n],d=3):k+=e:4===d?"--"===k&&">"===e?(d=1,k=""):k=e+k[0]:w?e===w?w="":k+=e:'"'===e||"'"===e?w=e:">"===e?(g(),d=1):d&&("="===e?(d=5,l=k,k=""):"/"===e&&(5>d||">"===a[p][z+1])?(g(),3===d&&(n=n[0]),d=n,(n=n[0]).push(2,0,d),d=0):" "===e||"\t"===e||"\n"===e||"\r"===e?(g(),d=2):k+=e),3===d&&"!--"===k&&(d=4,n=n[0])}return g(),n}(e)),a),arguments,[])).length?a:a[0]}.bind(function(e,a,...l){return"function"===typeof e?e:[()=>{Ia(e,null,null,...a?Object.keys(a).flatMap(g=>{"propName"===g&&(key=a[g]);
return[g,a[g]]}):[])},l.map(a=>()=>{"function"===typeof a?a():("string"===typeof a||"number"===typeof a)&&Ja(a)}),()=>Ha(e)]}),Qa=new WeakMap;function Ra(e){console.log(e);e.forEach(a=>{if(a)if(Array.isArray(a))Ra(a);else if(a.is===Ka){let e=xa();if(!e||8!==e.nodeType){let g=document.createComment("");e?e.parentElement.insertBefore(g,e):ca().appendChild(g);e=g;Qa.set(e,a())}za();Ra(Qa.get(e).next().value)}else a()})}
var $state=e=>{let a=[],l=!0;const g=K(e,()=>{l&&a.forEach(a=>a(g))});g.on=e=>{a.push(e);return()=>{const g=a.indexOf(e);1<g&&a.splice(g,1)}};g.merge=a=>{const e=a=>{Object.keys(a).forEach(d=>{["on","merge"].includes(d)||(g[d]=a[d])})};a.on(a=>{e(a)});l=!1;e(a);l=!0};return g};function component(e){function a(){return e()}a.is=Ka;return a};function render(e,a){Oa(()=>ya(e,function(){Ra(a)}))};export{$state,component,Pa as html,K as proxify,render}
